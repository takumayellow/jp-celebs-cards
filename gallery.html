<!doctype html><meta charset="utf-8"/>
<title>Gallery - jp-celebs-cards</title>
<style>
  :root{color-scheme:dark light}
  body{margin:24px;font:16px/1.5 system-ui}
  header{display:flex;gap:12px;align-items:center;margin-bottom:16px}
  input[type="search"]{padding:.5em .8em;border-radius:.6em;border:1px solid #888;min-width:260px}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:12px}
  .card{background:#0003;border:1px solid #555;border-radius:12px;padding:8px;text-align:center}
  .card img{width:100%;aspect-ratio:3/4;object-fit:cover;border-radius:8px;background:#222}
  .id{opacity:.7;font-size:12px;margin-top:4px}
</style>
<header>
  <h1 style="margin:0;font-size:20px;">Gallery</h1>
  <input id="q" type="search" placeholder="id かファイル名で絞り込み…">
  <span id="count"></span>
</header>
<div id="grid" class="grid"></div>
<script>
(async ()=>{
  const bust = Date.now();
  const res = await fetch('data/attr_map.json?v='+bust);
  const map = await res.json();
  const items = Object.entries(map).map(([id,fn])=>({id,fn}));
  const grid = document.getElementById('grid');
  const count = document.getElementById('count');
  function render(filter=''){
    grid.innerHTML = '';
    const f = filter.trim().toLowerCase();
    const list = f ? items.filter(x => (x.id+x.fn).toLowerCase().includes(f)) : items;
    for(const it of list){
      const url = 'images/'+it.fn+'?v='+bust;
      const div = document.createElement('div');
      div.className='card';
      div.innerHTML = `<img loading="lazy" src="${url}" alt="${it.id}">
                       <div class="id">${it.id}</div>
                       <div style="font-size:12px;opacity:.8">${it.fn}</div>`;
      grid.appendChild(div);
    }
    count.textContent = `表示: ${list.length} / ${items.length}`;
  }
  render();
  document.getElementById('q').addEventListener('input', e=>render(e.target.value));
})();
</script>
